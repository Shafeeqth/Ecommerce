<%- include('../partials/userHeader')%>

        <main class="main">
        	<div class="page-header text-center" style="background-image: url('/assets/images/page-header-bg.jpg')">
        		<div class="container">
        			<h1 class="page-title">Checkout</h1>
        		</div><!-- End .container -->
        	</div><!-- End .page-header -->
            <nav aria-label="breadcrumb" class="breadcrumb-nav">
                <div class="container">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="/api/v1/">Home</a></li>
                        <li class="breadcrumb-item"><a href="/api/v1/shop">Shop</a></li>
                        <li class="breadcrumb-item active" aria-current="page">Checkout</li>
                    </ol>
                </div><!-- End .container -->
            </nav><!-- End .breadcrumb-nav -->

            <div class="page-content">
            	<div class="checkout">
	                <div class="container">
            			

            			<form action="/api/v1/confirm-order" method="POST" >
		                	<div class="row m-0">
		                		<div class="col-lg-9 ">
									<div class="accordion " id="accordionExample">
										<div class="accordion-item ">
										 
											
												<h4 class="accordion-header  border row justify-content-center bg-light" id="headingOne" style="height: 4rem;">
													<button style="all: unset;" class="accordion-button btn-secondary " type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="true" aria-controls="collapseOne"><span>Delivery Addresses</span></button>
												
												</h4>
											
										  
										  <div id="collapseOne" class="accordion-collapse collapse  " aria-labelledby="headingOne" data-bs-parent="#accordionExample">
											<div class="accordion-body">
												<div class="row justify-content-center">
										
													<%if(address && address.length > 0) {%>
														<div class="col-lg-5 ">
															
															<div class="card card-dashboard ">
																<div class="row justify-content-start">
																<input style="margin-left: 3rem; margin-top: 3rem" class="text-start" type="radio" name="address" checked value="<%=address[0]._id%>" >
																</div>
															
																<div class="card-body pt-2">
																	<h3 class="card-title">
																		<%=address[0]?.name%>
																	</h3><!-- End .card-title -->
			
			
																	<p>
																		Phone: <%=address[0]?.phone%><br>
																			State: <%=address[0]?.state%><br>
																				District: <%=address[0]?.district%><br>
																					Locality: <%=address[0]?.locality%><br>
																						Pincode: <%=address[0]?.pincode%><br>
																							Street: <%=address[0]?.street%><br>
																								<a
																									href="/api/v1/profile/edit-address?id=<%=address[0]._id%>">Edit
																									<i class="icon-edit"></i></a>
																									
																	</p>
																</div><!-- End .card-body -->
															</div><!-- End .card-dashboard -->
														</div><!-- End .col-lg-6 -->
													
														<%for(let i = 1; i < address.length; i++) {%>
														
														<div class="col-lg-5 ">
															
															<div class="card card-dashboard ">
																<div class="row justify-content-start">
																<input style="margin-left: 3rem; margin-top: 3rem" class="text-start" type="radio" name="address"  value="<%=address[i]._id%>" >
																</div>
															
																<div class="card-body pt-2">
																	<h3 class="card-title">
																		<%=address[i]?.name%>
																	</h3><!-- End .card-title -->
			
			
																	<p>
																		Phone: <%=address[i]?.phone%><br>
																			State: <%=address[i]?.state%><br>
																				District: <%=address[i]?.district%><br>
																					Locality: <%=address[i]?.locality%><br>
																						Pincode: <%=address[i]?.pincode%><br>
																							Street: <%=address[i]?.street%><br>
																								<a
																									href="/api/v1/profile/edit-address?id=<%=address[i]._id%>">Edit
																									<i class="icon-edit"></i></a>
																									
																	</p>
																</div><!-- End .card-body -->
															</div><!-- End .card-dashboard -->
														</div><!-- End .col-lg-6 -->
												
											
													
														<%}%>
														
														<%}%>
														<div class="container">
														<div class=" row mb-2  justify-content-center text-center;">
									
															<a class="btn btn-primary" href="/api/v1/profile/add-address">Add new Address <i class="icon-edit"></i></a>
														</div>
													</div>
														
			
			
												</div><!-- End .row -->
											</div>
										  </div>
										</div>
										<div class="accordion-item ">
										  <h4 class="accordion-header d-flex justify-content-center border bg-light" id="headingTwo"  style="height: 4rem;">
											<button class="accordion-button collapsed" style="all: unset;" type="button" data-bs-toggle="collapse" data-bs-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
											  <span>Products</span>
											</button>
										  </h4>
										  <div id="collapseTwo" class="accordion-collapse collapse show" aria-labelledby="headingTwo" data-bs-parent="#accordionExample">
											<div class="accordion-body">
												<table class="table table-cart table-mobile">
													<thead>
														<tr>
															<th>Product</th>
															<th>Price</th>
															<th>Quanlity</th>
															<th>Total</th>
															<th></th>
														</tr>
													</thead>
				
													<tbody>
														<%let grandTotal = 0;%>
														<%if(Array.isArray(cartData.products) && cartData.products.length > 0) {%>
															
															<%cartData.products.forEach(cart => {%>
																<%total = 0%>
																
																
				
															
														<tr>
															<td class="product-col">
																<div class="product">
																	<figure class="product-media">
																		<a href="/api/v1/product-detail?id=<%=cart.product._id%>">
																			<img src="/Data//uploads/<%=cart.product.images[0]%>" alt="Product image">
																		</a>
																	</figure>
				
																	<h3 class="product-title">
																		<a href="/api/v1/product-detail?id=<%=cart.product._id%>"><%= cart.product.title%></a>
																	</h3><!-- End .product-title -->
																</div><!-- End .product -->
															</td>
															<td class="price-col">₹<%=cart.product.price%>.00</td>
															<%total = +cart.product.price * cart.quantity%>%>
															<td class="quantity-col">
																<div class="cart-product-quantity row">
																	<input disabled type="text" class="form-control" value="<%=cart.size%>" >
																	<input disabled type="text" class="form-control" value="<%=cart.quantity%>" >
																</div><!-- End .cart-product-quantity -->
															</td>
															
															
															<td class="total-col">₹<%= total%>.00</td>
															<td class="remove-col"><button onclick="removeFromCart('<%=cart.id%>','<%=cart.product.title%>')" class="btn-remove"><i class="icon-close"></i></button></td>
														</tr>
														<% grandTotal += +total %>
														<%})%>
				
														<%}else{%>
															<tr class="h-100">
																<td colspan="5">
																	<p class="text-center ">Your cart is empty please add items to the cart.</p>
																</td>
															</tr>
															
				
															<%}%>
														
														
													</tbody>
												</table><!-- End .table table-wishlist -->											</div>
										  </div>
										</div>
									</div>
									
									
									<div class="cart-discount my-4">
										<form action="#">
											<div class="input-group">
												<input type="text" class="form-control m-0"  placeholder="coupon code">
												<div class="input-group-append">
													<button class="btn btn-outline-primary-2" type=""><i class="icon-long-arrow-right"></i></button>
												</div><!-- .End .input-group-append -->
											</div><!-- End .input-group -->
										</form>
									</div><!-- End .cart-discount -->
		                		</div><!-- End .col-lg-9 -->
								
		                		<aside class="col-lg-3">
		                			<div class="summary">
										<table class="table table-summary">
		                					<thead>
		                						
		                					</thead>

		                					<tbody>
											
		                						
		                						<tr class="summary-subtotal">
		                							<td>Subtotal:</td>
		                							<td>₹<%=grandTotal%>.00</td>
		                						</tr><!-- End .summary-subtotal -->
		                						<tr>
		                							<td>Shipping:</td>
		                							<td>Free shipping</td>
		                						</tr>
		                						<tr class="summary-total">
		                							<td>Total:</td>
		                							<td>₹<%=grandTotal%>.00</td>
		                						</tr><!-- End .summary-total -->
												
		                					</tbody>
		                				</table><!-- End .table table-summary -->
		                				

		                				<%if(Array.isArray(cartData.products) && cartData.products.length > 0 && address && address.length > 0) {%>

		                				<div class="accordion-summary" id="accordion-payment">
										    <div class="card">
										        <div class="card-header" id="heading-1">
										            <h2 class="card-title">
													<input style="text-decoration: none;" role="button"   data-bs-toggle="collapse" data-bs-target="#collapse-1" aria-expanded="true" aria-controls="collapse-1" class="text-start" type="radio" name="paymentMethod" checked value="wallet" >
										                
										                   Pay Using Wallet
										               
										            </h2>
										        </div><!-- End .card-header -->
										        <div id="collapse-1" class="collapse " aria-labelledby="heading-1" data-parent="#accordion-payment" value="paypal" >
										            <div class="card-body"> 

														Digital wallets allow you to pay when you're shopping using your device so that you don't need to carry your cards around.
										            </div><!-- End .card-body -->
										        </div><!-- End .collapse -->
										    </div><!-- End .card -->

										   

										    <div class="card">
										        <div class="card-header" id="heading-3">
										            <h2 class="card-title">
														<input  class="collapsed"  role="button"   data-bs-toggle="collapse" data-bs-target="#collapse-3" aria-expanded="false" aria-controls="collapse-3" class="text-start" type="radio" name="paymentMethod"  value="cashOnDelivery" >
										              
										                    Cash on delivery
										             
										            </h2>
										        </div><!-- End .card-header -->
										        <div id="collapse-3" class="collapse" aria-labelledby="heading-3" data-parent="#accordion-payment">
										            <div class="card-body">A cash transaction refers to exchanging goods or services where payment is made in physical currency. 
										            </div><!-- End .card-body -->
										        </div><!-- End .collapse -->
										    </div><!-- End .card -->

										    <div class="card">
										        <div class="card-header" id="heading-4">
										            <h2 class="card-title">
														
														<input class="collapsed"  role="button" onclick="sendPayPal()"  data-bs-toggle="collapse" data-bs-target="#collapse-4" aria-expanded="false" aria-controls="collapse-4" class="text-start" type="radio" name="paymentMethod"  value="paypal" >
										               
										                    PayPal <small class="float-right paypal-link">What is PayPal?</small>
										                </a>
										            </h2>
										        </div><!-- End .card-header -->
										        <div id="collapse-4" class="collapse" aria-labelledby="heading-4" data-parent="#accordion-payment">
										            <div class="card-body">
														PayPal is an online payment system that allows you to send and receive money around the world.
										            </div><!-- End .card-body -->
										        </div><!-- End .collapse -->
										    </div><!-- End .card -->

										    
										</div><!-- End .accordion -->
									
										
		                				<button type="submit" class="btn btn-outline-primary-2 btn-order btn-block">
		                					<span class="btn-text">Place Order</span>
		                					<span class="btn-hover-text">Confirm Order</span>
		                				</button>
										<%}%>
										
		                			</div><!-- End .summary -->
		                		</aside><!-- End .col-lg-3 -->
		                	</div><!-- End .row -->
            			</form>
	                </div><!-- End .container -->
                </div><!-- End .checkout -->
            </div><!-- End .page-content -->
        </main><!-- End .main -->
		<script>
			function sendPayPal() { 
			fetch('/paypal/pay',{
				method: "POST"
			}).then(response => response.json())
			.then(response => console.log(response));
		}
		</script>

        <%- include('../partials/userFooter')%>
    <!-- Plugins JS File -->
    <script src="/assets/js/jquery.min.js"></script>
    <script src="/assets/js/bootstrap.bundle.min.js"></script>
    <script src="/assets/js/jquery.hoverIntent.min.js"></script>
    <script src="/assets/js/jquery.waypoints.min.js"></script>
    <script src="/assets/js/superfish.min.js"></script>
    <script src="/assets/js/owl.carousel.min.js"></script>
    <!-- Main JS File -->
    <script src="/assets/js/main.js"></script>
</body>


<!-- molla/checkout.html  22 Nov 2019 09:55:06 GMT -->
</html>