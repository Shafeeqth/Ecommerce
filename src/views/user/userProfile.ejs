<%- include('../partials/userHeader') -%>
	<main class="main">
		<div class="page-header text-center" style="background-image: url('/assets/images/page-header-bg.jpg')">
			<div class="container">
				<h1 class="page-title">My Account</h1>
			</div><!-- End .container -->
		</div><!-- End .page-header -->
		<nav aria-label="breadcrumb" class="breadcrumb-nav mb-3">
			<div class="container">
				<ol class="breadcrumb">
					<li class="breadcrumb-item"><a href="/api/v1/">Home</a></li>
					<li class="breadcrumb-item"><a href="/api/v1/shop">Shop</a></li>
					<li class="breadcrumb-item active" aria-current="page">My Account</li>
				</ol>
			</div><!-- End .container -->
		</nav><!-- End .breadcrumb-nav -->

		<div class="page-content">
			<div class="dashboard">
				<div class="container">
					<div class="row">
						<aside class="col-md-3 col-lg-2">
							<ul class="nav nav-dashboard flex-column mb-3 mb-md-0" role="tablist">
								<li class="nav-item">
									<a class="nav-link active" id="tab-dashboard-link" data-toggle="tab"
										href="#tab-dashboard" role="tab" aria-controls="tab-dashboard"
										aria-selected="true">Dashboard</a>
								</li>
								<li class="nav-item">
									<a class="nav-link" id="tab-wallet-link" href="/api/v1/profile/my-orders"
										aria-selected="false">My Orders</a>
								</li>
								<li class="nav-item">
									<a class="nav-link" id="tab-wallet-link" data-toggle="tab" href="#tab-wallet"
										role="tab" aria-controls="tab-address" aria-selected="false">My Wallet</a>
								</li>
								<li class="nav-item">
									<a class="nav-link" id="tab-downloads-link" href="/api/v1/wishlist"
										aria-selected="false">My Wishlist</a>
								</li>
								<li class="nav-item">
									<a class="nav-link" id="tab-account-link" href="/api/v1/cart"
										aria-selected="false">My
										Cart</a>
								</li>
								
								<li class="nav-item">
									<a class="nav-link" id="tab-address-link" data-toggle="tab" href="#tab-address"
										role="tab" aria-controls="tab-address" aria-selected="false">Adresses</a>
								</li>

								<li class="nav-item">
									<a class="nav-link"><button style="all: unset;"
											onclick="logout()">Logout</button></a>
								</li>
							</ul>
						</aside><!-- End .col-lg-3 -->

						<div class="col-md-9 col-lg-10">
							<div class="tab-content">

								<div class="tab-pane fade show active" id="tab-dashboard" role="tabpanel"
									aria-labelledby="tab-dashboard-link">


									<div class="row position-relative">
										<%if(Array.isArray(userProfile)) {%>
											<div class="col-lg-12 h-100">
												<div class="card card-dashboard">
													<div class="card-body text-center">
														<h3 class="card-title fw-bold">Account Detail</h3>
														<!-- End .card-title -->

														<p class="fw-bold">
															<%=userProfile[0]?.name%><br>
																<%=userProfile[0]?.email%><br>
																	<%=userProfile[0]?.joinedAt%>
														</p><br>


														<!-- <a class="mx-3" href=""> </a>
															<a class="mx-3"  href=""> </a></p> -->

														<div class="accordion " id="accordionExample">
															<div class="accordion-item m-5">
																<a class="accordion-header btn btn-primary"
																	id="headingOne">
																	<button style="all: unset;"
																		class="text-white accordion-button"
																		type="button" data-bs-toggle="collapse"
																		data-bs-target="#collapseOne"
																		aria-expanded="true"
																		aria-controls="collapseOne">
																		Change password <i class="icon-edit"></i>
																	</button>
																</a>
																<div id="collapseOne"
																	class="accordion-collapse collapse "
																	aria-labelledby="headingOne"
																	data-bs-parent="#accordionExample">
																	<div
																		class="accordion-body my-4 row justify-content-center">
																		<div class="col-10">
																			<label> Current password </label>
																			<input type="password" class="form-control"
																				id="password"><input type="checkbox"
																				onclick="show()"
																				style="position: absolute; top: 15%; left: 95%;">
																			<div class="text-danger" id="currentError"
																				style="position: absolute; top: -18px; left: 24rem">
																			</div>



																			<label>New password </label>

																			<input type="password" class="form-control"
																				id="new-password">
																			<div class="text-danger" id="newError"
																				style="position: absolute; top: 23%; left:43%;">
																			</div>
																			<label style="position: relative;">Confirm new password</label>
																			<div class="text-danger" id="confirmError"
																				style="position: absolute; top: 23%; left:43%;">
																			</div>
																			<input type="password"
																				class="form-control mb-2"
																				id="confirm-password">

																			<button onclick="changePassword()"
																				type="submit"
																				class="btn btn-outline-primary-2">
																				<span>SAVE CHANGES</span>
																				<i class="icon-long-arrow-right"></i>
																			</button>
																		</div>
																	</div>
																</div>
															</div>
															<div class="accordion-item m-5">
																<a class="accordion-header btn btn-primary"
																	id="headingTwo">
																	<button style="all: unset;"
																		class=" text-white accordion-button collapsed"
																		type="button" data-bs-toggle="collapse"
																		data-bs-target="#collapseTwo"
																		aria-expanded="false"
																		aria-controls="collapseTwo">
																		Edit details <i class="icon-edit"></i>
																	</button>
																</a>
																<div id="collapseTwo"
																	class="accordion-collapse collapse"
																	aria-labelledby="headingTwo"
																	data-bs-parent="#accordionExample">
																	<div
																		class="accordion-body my-4 row justify-content-center">
																		<div class="col-10">
																			<div id="error-div"
																				class="alert text-danger  fw-bold bg-light rounded text-center  border border-danger"
																				role="alert" style="display: none;">
																			</div>
																			<label> Username* </label>
																			<input type="text" class="form-control"
																				name="name"
																				value="<%=userProfile[0]?.name%>"
																				id="nameField">


																			<button onclick="changeUserDetails()"
																				type="button"
																				class="btn btn-outline-primary-2">
																				<span>SAVE CHANGES</span>
																				<i class="icon-long-arrow-right"></i>
																			</button>
																		</div>
																	</div>
																</div>
															</div>








														</div>

														<hr>
														<div class="collapse collapsed row justify-content-center align-items-center"
															id="multiCollapseExample1"
															style="background-color:rgba(219, 224, 215, 0.1) ;">


														</div>
														<div class="collapse collapsed row justify-content-center align-items-center "
															id="multiCollapseExample2"
															style="background-color:rgba(219, 224, 215, 0.1) ;">


														</div>
													</div><!-- End .card-body -->
												</div><!-- End .card-dashboard -->
											</div><!-- End .col-lg-6 -->


									</div><!-- End .row -->
								</div><!-- .End .tab-pane -->
								<style>
 

									.containerrr {
									  display: flex;
									  flex-wrap: wrap;
									}
								
									.sidebarrr {
									  flex: 1;
									  min-width: 20%;
									  max-width: 25%;
									  padding: 20px;
									 
									  color: #fff;
									  min-height: 100vh;
									}
								
									.main-contenttt {
									  flex: 3;
									  padding: 20px;
									}hr{
										color:black;
									}
								
									.user-headerrr {
									  display: flex;
									  align-items: center;
									  margin-bottom: 20px;
									}
								
									.user-photooo {
									  border-radius: 50%;
									  width: 40px;
									  height: 40px;
									  margin-right: 10px;
									  /* Placeholder background color for the user photo */
									  background-color: #ddd;
									}
								
									.user-nameee {
									  font-size: .6rem;
									  font-weight: bold;
									}
								
									.menu-headinggg {
									  font-size: .7rem;
									  font-weight: bold;
									  margin-bottom: 10px;
									  color: rgba(127,127,127,1);
									}
								
									.menu-itemmm {
									  margin-bottom: 10px;
								
									}
								
									.menu-itemmm a {
									 color: black;
									  text-decoration: none;
									  font-size: .9rem;
									  font-family: 'Quicksand';
									}
									.menu-itemmm.selected {
								  background-color: #f0f0f0;
								  border-radius: 5px;
								}
								
									@media screen and (max-width: 600px) {
										.menu-itemmm a {
									 color: black;
									  text-decoration: none;
									  font-size: .5rem;
									}   
								
								}
								
								
								
								
								/* wallet  */
								.card{
									border: none;
									border-radius: 10px;
									width: 50%;
								  
									
								}
								.fa-ellipsis-v{
									font-size: 10px;
									color: #C2C2C4;
									margin-top: 6px;
									cursor: pointer;
								}
								.text-dark{
									font-weight: bold;
									margin-top: 8px;
									font-size: 13px;
									letter-spacing: 0.5px;
								}
								.card-bottom{
									background: #3E454D;
									border-radius: 6px;
								}
								
								.flex-column p{
									letter-spacing: 1px;
									font-size: 18px;
								}
								.btn-secondary{
									height: 40px!important;
									margin-top: 3px;
								}
								.btn-secondary:focus{
									box-shadow: none;
								}
							 </style>


								<div class="tab-pane fade" id="tab-wallet" role="tabpanel"
									aria-labelledby="tab-wallet-link">
									<div class="card-body">
										<div id="edit-profile-section"   style="display: block;"  >
											<h1>Wallet</h1>
											
											<div class="mt-5">
											 
											 
											 <div class="table-responsive">
											   <div class=" d-flex ">
												 <div class="card p-3">
												   <div class="d-flex flex-row justify-content-between text-align-center">
											  
													 <i class="fas fa-ellipsis-v"></i>
												   </div>
												   <p class="text-dark"><%= wallet?.user?.name  %> Account</p>
												   <div class="card-bottom pt-3 px-3 mb-2">
													 <div class="d-flex flex-row justify-content-between text-align-center">
													   <div class="d-flex flex-column" style="	color: #adb5bd;
													   font-size: 13px;" ><span>Balance amount</span><p>₹ <span class="text-white"><%= wallet?.balance  %></span></p></div>
											   
													 </div>
												   </div>
												   <div class="new-div">
													 <div class="car"  >
													  <div class="card-body">
													   <h4 class="card-title text-center">Transaction History</h4>
													   <hr>
													   <%if(wallet?.transactions?.length > 0){%>
														 <% walletHistory.forEach((walletHistory)=>{ %>
														   <div class="d-flex justify-content-between transction- " >
															 <p ><%= walletHistory.date.toLocaleDateString('en-US',
															   { year: 'numeric', month: 'short', day: '2-digit'
															   }) %></p>
															 <p>
															   ₹<%=  walletHistory.amount %>
															 </p>
															 <p>
															   <%= walletHistory.mode %>
															 </p>
														   </div>
														 
														   <%})%>
													   
													   <% } %>
													  
													   <button class="btn text-white w-100" style="background-color: #3E454D">Add Money</button>
									   
													  </div>
													 </div>
													 
													 <!-- Add your content here -->
												   </div>
												 </div>
											   </div>
											
											 </div>
										 </div>
									   
										 </div>
									   
									</div>
								</div><!-- .End .tab-pane -->

								<div class="tab-pane fade" id="tab-downloads" role="tabpanel"
									aria-labelledby="tab-downloads-link">
									<p>No downloads available yet.</p>
									<a href="category.html" class="btn btn-outline-primary-2"><span>GO SHOP</span><i
											class="icon-long-arrow-right"></i></a>
								</div><!-- .End .tab-pane -->

								<div class="tab-pane fade" id="tab-address" role="tabpanel"
									aria-labelledby="tab-address-link">
									<h3 class="text-center mb-3">My Addresses</h3>

									<div class="d-flex my-4" style="justify-content: space-between;">
										<p>The following addresses will be used on the checkout page by default.</p>

										<a href="/api/v1/profile/add-address" class="btn btn-primary text-end"><span>Add
												New
												Address</span></a>

									</div>
									<div class="row" id="">
										<%userProfile?.forEach(profile=> {%>
											<div class="col-lg-6">
												<div class="card card-dashboard">
													<div class="card-body">
														<h3 class="card-title">
															<%=profile.addresses?.name%>
														</h3><!-- End .card-title -->


														<p>
															<%=profile.addresses?.phone%><br>
																<%=profile.addresses?.state%><br>
																	<%=profile.addresses?.district%><br>
																		<%=profile.addresses?.locality%><br>
																			<%=profile.addresses?.pincode%><br>
																				<%=profile.addresses?.street%><br>
																					<div class="row align-items-center"
																						style="justify-content: space-evenly;">
																						<a class="btn btn-primary"
																							href="/api/v1/profile/edit-address?id=<%=profile.addresses._id%>">Edit
																							<i
																								class="icon-edit"></i></a>
																						<button style="all: unset;"
																							onclick="deleteAddress('<%=profile.addresses._id%>')"><a
																								class="btn btn-primary text-white pointer">
																								Delete
																								<i
																									class="icon-edit"></i></a></button>
																					</div>


														</p>
													</div><!-- End .card-body -->
												</div><!-- End .card-dashboard -->
											</div><!-- End .col-lg-6 -->
											<%})%>


									</div><!-- End .row -->
								</div><!-- .End .tab-pane -->

								<div class="tab-pane fade" id="tab-account" role="tabpanel"
									aria-labelledby="tab-account-link">
									<div>
										<div class="row">
											<div class="col-sm-6">
												<label>First Name *</label>
												<input type="text" class="form-control" required id="">
											</div><!-- End .col-sm-6 -->

											<div class="col-sm-6">
												<label>Last Name *</label>
												<input type="text" class="form-control" required id="">
											</div><!-- End .col-sm-6 -->
										</div><!-- End .row -->

										<label>Display Name *</label>
										<input type="text" class="form-control" required>
										<small class="form-text">This will be how your name will be displayed in the
											account section and in reviews</small>

										<label>Email address *</label>
										<input type="email" class="form-control" required>

										<label>Current password (leave blank to leave unchanged)</label>
										<input type="password" class="form-control">

										<label>New password (leave blank to leave unchanged)</label>
										<input type="password" class="form-control">

										<label>Confirm new password</label>
										<input type="password" class="form-control mb-2">

										<button type="submit" class="btn btn-outline-primary-2">
											<span>SAVE CHANGES</span>
											<i class="icon-long-arrow-right"></i>
										</button>
										</form>
									</div><!-- .End .tab-pane -->
								</div>
							</div><!-- End .col-lg-9 -->
						</div><!-- End .row -->
					</div><!-- End .container -->
				</div><!-- End .dashboard -->
			</div><!-- End .page-content -->
	</main><!-- End .main -->
	<%}%>
		<script>
			document.addEventListener('DOMContentLoaded', function () {
				let currentPassword = document.getElementById('password');
				let newPassword = document.getElementById('new-password');
				let confirmtPassword = document.getElementById('confirm-password');

				let curPassword = currentPassword.value;
				let nPassword = newPassword.value;
				let conPassword = confirmtPassword.value;

				let newError = document.getElementById('newError');
				let confirmError = document.getElementById('confirmError');

				newPassword.addEventListener('keyup', function (event) {



					if (!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d).{6,}$/.test(newPassword.value)) {
						newPassword.style.border = '1px red solid';
						newError.classList = 'text-danger'
						newError.innerText = 'Week password'

					}
					if (/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()\-_=+\\\|\[\]{};:\'",.<>?]).{6,}$/.test(newPassword.value)) {
						newPassword.style.border = '1px green solid'
						newError.classList = 'text-success'
						newError.innerText = 'Strong password'


					}
					if (newPassword.value.trim().length == 0) {
						newPassword.style.border = '1px red solid';
						newError.innerText = 'Password is required'

					}
				});

				newPassword.addEventListener('blur', function (event) {

					if (/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%^&*()\-_=+\\\|\[\]{};:\'",.<>?]).{6,}$/.test(newPassword.value)) {
						newPassword.removeAttribute('style');


					}

				});


				confirmtPassword.addEventListener('keyup', function (event) {

					if (!(newPassword.value === confirmtPassword.value)) {
						confirmtPassword.style.border = '1px red solid';
						confirmError.classList = 'text-danger'
						// confirmError.innerText = 'Password mismatch'

					}
					if (!newPassword.value) {
						newPassword.style.border = '1px red solid';
						passwordError.classList = 'text-danger'
						passwordError.innerText = 'Please Enter password '
						confirmtPassword.style.border = '1px red solid';
						confirmError.classList = 'text-danger'

					}
					if (newPassword.value === confirmtPassword.value) {
						confirmtPassword.style.border = '';
						confirmError.classList = ''
						confirmError.innerText = ''
					}
					if (confirmtPassword.value.trim().length == 0) {
						confirmtPassword.style.border = '1px red solid';
						confirmError.innerText = ''

					}

				})
			})
		</script>

		<%- include('../partials/userFooter') -%>
			<!-- Plugins JS File -->
			<script src="/assets/js/jquery.min.js"></script>
			<script src="/assets/js/bootstrap.bundle.min.js"></script>
			<script src="/assets/js/jquery.hoverIntent.min.js"></script>
			<script src="/assets/js/jquery.waypoints.min.js"></script>
			<script src="/assets/js/superfish.min.js"></script>
			<script src="/assets/js/owl.carousel.min.js"></script>
			<!-- Main JS File -->
			<script src="/assets/js/main.js"></script>
			</body>


			<!-- molla/dashboard.html  22 Nov 2019 10:03:13 GMT -->

			</html>